<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Cormac Flanagan (UC, Santa Cruz)" />
  <meta name="author" content="Stephen Freund (Williams College)" />
  <title>Artifact: The Anchor Verifier for Blocking and Non-Blocking Concurrent Software</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <style type="text/css">
html {
font-size: 100%;
overflow-y: scroll;
-webkit-text-size-adjust: 100%;
-ms-text-size-adjust: 100%;
}
body {
color: #222;
font-family: Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif;
font-size: 12px;
line-height: 1.7;
padding: 1em;
margin: auto;
max-width: 65em;
background: #fefefe;
}
a {
color: #0645ad;
text-decoration: none;
}

a:hover {
color: #06e;
}
a:active {
color: #faa700;
}
a:focus {
outline: thin dotted;
}
*::-moz-selection {
background: rgba(255, 255, 0, 0.3);
color: #000;
}
*::selection {
background: rgba(255, 255, 0, 0.3);
color: #000;
}
a::-moz-selection {
background: rgba(255, 255, 0, 0.3);
color: #0645ad;
}
a::selection {
background: rgba(255, 255, 0, 0.3);
color: #0645ad;
}
p {
margin: 1em 0;
}
img {
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
color: #111;
line-height: 125%;
margin-top: 2em;
font-weight: normal;
}
h5, h6 {
margin-bottom: -0.5em;
}
h4, h5, h6 {
font-weight: bold;
}
h1 {
font-size: 2.5em;
padding-bottom: 0.1em;
padding-top: 0.3em;
border-bottom: 5px #000091 solid;
border-top: 5px #000091 solid;
}
h2 {
font-size: 2em;
}
h3 {
font-size: 1.5em;
}
h4 {
font-size: 1.2em;
}
h5 {
font-size: 1em;
}
h6 {
font-size: 0.9em;
}
blockquote {
color: #666666;
margin: 0;
padding-left: 3em;
border-left: 0.5em #EEE solid;
}
hr {
display: block;
height: 5px;
border: 0;
border-top: 1px solid #aaa;
border-bottom: 1px solid #eee;
margin: 1em 0;
padding: 0;
}
pre, code, kbd, samp {
line-height: 1.25;
color: #000;
background-color: #EFEFEF;
font-family: monospace, monospace;
_font-family: 'courier new', monospace;
font-size: 0.98em;
}
pre {
white-space: pre;
white-space: pre-wrap;
word-wrap: break-word;
padding: 0.25em 0.25em;
}
b, strong {
font-weight: bold;
}
dfn {
font-style: italic;
}
ins {
background: #ff9;
color: #000;
text-decoration: none;
}
mark {
background: #ff0;
color: #000;
font-style: italic;
font-weight: bold;
}
sub, sup {
font-size: 75%;
line-height: 0;
position: relative;
vertical-align: baseline;
}
sup {
top: -0.5em;
}
sub {
bottom: -0.25em;
}
ul, ol {
margin: 1em 0;
padding: 0 0 0 2em;
}
li p:last-child {
margin-bottom: 0;
}
ul ul, ol ol {
margin: .3em 0;
}
dl {
margin-bottom: 1em;
}
dt {
font-weight: bold;
margin-bottom: .8em;
}
dd {
margin: 0 0 .8em 2em;
}
dd:last-child {
margin-bottom: 0;
}
img {
border: 0;
-ms-interpolation-mode: bicubic;
vertical-align: middle;
}
figure {
display: block;
text-align: center;
margin: 1em 0;
}
figure img {
border: none;
margin: 0 auto;
}
figcaption {
font-size: 0.8em;
font-style: italic;
margin: 0 0 .8em;
}
table {
margin-bottom: 2em;
border-bottom: 1px solid #ddd;
border-right: 1px solid #ddd;
border-spacing: 0;
border-collapse: collapse;
}
table th {
padding: .2em 1em;
background-color: #eee;
border-top: 1px solid #ddd;
border-left: 1px solid #ddd;
}
table td {
padding: .2em 1em;
border-top: 1px solid #ddd;
border-left: 1px solid #ddd;
vertical-align: top;
}
.author {
line-height: 0.75;
font-size: 1.5em;
text-align: center;
}
@media only screen and (min-width: 480px) {
body {
font-size: 16px;
}
}
@media only screen and (min-width: 768px) {
body {
font-size: 18px;
}
}
@media print {
* {
background: transparent !important;
color: black !important;
filter: none !important;
-ms-filter: none !important;
}
body {
font-size: 12pt;
max-width: 100%;
}
a, a:visited {
text-decoration: underline;
}
hr {
height: 1px;
border: 0;
border-bottom: 1px solid black;
}
a[href]:after {
content: " (" attr(href) ")";
}
abbr[title]:after {
content: " (" attr(title) ")";
}
.ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
content: "";
}
pre, blockquote {
border: 1px solid #999;
padding-right: 1em;
page-break-inside: avoid;
}
tr, img {
page-break-inside: avoid;
}
img {
max-width: 100% !important;
}
@page :left {
margin: 15mm 20mm 15mm 10mm;
}
@page :right {
margin: 15mm 10mm 15mm 20mm;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3 {
page-break-after: avoid;
}
}
code span.dt { color: #000000; } 
code span.va { color: #1917Ac; } 
div.sourceCode {background-color: #EFEFEF;}
</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Artifact: The Anchor Verifier for Blocking and Non-Blocking Concurrent Software</h1>
<p class="author">Cormac Flanagan (UC, Santa Cruz)</p>
<p class="author">Stephen Freund (Williams College)</p>
</header>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#version-2">Version 2</a></li>
<li><a href="#getting-started">Getting Started</a>
<ul>
<li><a href="#downloading">Downloading</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#quick-start">Quick Start</a></li>
</ul></li>
<li><a href="#step-by-step-instructions">Step-By-Step Instructions</a>
<ul>
<li><a href="#claims-validated-with-artifact">Claims Validated With Artifact</a></li>
<li><a href="#claims-1-and-2-demonstrated-by-verifying-examples-in-the-paper-and-others">Claims 1 and 2: Demonstrated by Verifying Examples in the Paper and Others</a></li>
<li><a href="#claim-3-demonstrated-by-verifying-examples-in-the-paper">Claim 3: Demonstrated by Verifying Examples in the Paper</a></li>
<li><a href="#claim-4-demonstrated-by-verifying-examples-in-the-paper-and-others">Claim 4: Demonstrated by Verifying Examples in the Paper and Others</a></li>
<li><a href="#claims-5-6-7-demonstrated-by-verifying-the-examples-in-table-1">Claims 5, 6, 7: Demonstrated by Verifying the Examples in Table 1</a></li>
<li><a href="#claims-4-5-6-7-demonstrated-by-the-civl-fasttrack-case-study">Claims 4, 5, 6, 7: Demonstrated by the CIVL FastTrack Case Study</a></li>
<li><a href="#version-2-claims-4567-demonstrated-by-our-armada-queue-case-study"><strong>Version 2:</strong> Claims 4,5,6,7: Demonstrated by our Armada Queue Case Study</a></li>
<li><a href="#claim-8-demonstrated-by-compiling-and-testing-the-examples-in-table-1">Claim 8: Demonstrated by Compiling and Testing the Examples in Table 1</a></li>
</ul></li>
<li><a href="#building-and-unit-tests">Building and Unit Tests</a></li>
<li><a href="#known-issues-and-caveats">Known Issues And Caveats</a></li>
</ul>
</nav>
<h2 id="version-2">Version 2</h2>
<p>This artifact includes several additions and changes from the original version reviewed for OOPSLA ’20. The main changes are:</p>
<ul>
<li>We include an additional case study for direct comparison to Armada.</li>
<li>We made various small bug fixes and performance improvements, so timing numbers may be different.</li>
<li>We modified some example code to clean up rough edges and make more clear, again leading to some minor differences with version 1 in code size and running times.</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<h3 id="downloading">Downloading</h3>
<p>The artifact for our paper is packaged as a virtual machine available at the link provided.</p>
<h3 id="overview">Overview</h3>
<p>We created and tested this Ubuntu 16 VM in VMWare Fusion 11.5.5. We have also run it in VirtualBox 6.1.12.</p>
<p>The VM contains the software infrastructure to use Anchor. The username and password to log in are both <code>artifact</code>. Terminal windows and FireFox can be opened from the toolbar on the left.</p>
<p>Once logged in, this file can be found in <code>~/Synchronicity/workspace/artifact/artifact.html</code>. That version includes clickable links to a number of other files, so we suggest opening it in Firefox as you proceed through the steps below.</p>
<p>Below you will find Quick Start instructions to run Anchor on some small prorgams, as well as instructions to run the benchmark experiments reported in the paper.</p>
<h4 id="machine-requirements">Machine Requirements</h4>
<p>We used a real machine with a 3.2 GHz 6-Core Intel Core i7 process and 64 GB of memory running MacOS 10.15 to generate the results in the paper. Any reasonably-sized computer or virtual machine should be able to run all experiments, with perhaps some variability in timing results. When using our VM, here are two general configurations and what to expect:</p>
<ul>
<li><p><strong>Preferred:</strong> The VM we provide runs Ubuntu 16 and is initially set to use 8GB of memory and 2 CPUs. That size should be suitable for running Anchor on all programs.</p></li>
<li><p><strong>Minimal:</strong> With 4GB and 1 CPU, most tests and benchmarks will run, but you may encounter failures due to memory depletion and/or see some slowdowns.</p></li>
</ul>
<h4 id="relevant-papers-and-books">Relevant Papers and Books</h4>
<ul>
<li>VerifiedFT (PPoPP 2018): <a href="https://dl.acm.org/doi/10.1145/3178487.3178514">https://dl.acm.org/doi/10.1145/3178487.3178514</a></li>
<li>CIVL (Concur 2015): <a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/paper-12.pdf">https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/paper-12.pdf</a></li>
<li>Armada (PLDI 2020): <a href="https://dl.acm.org/doi/10.1145/3385412.3385971">https://dl.acm.org/doi/10.1145/3178487.3178514</a></li>
<li>Maurice Herlihy and Nir Shavit, <em>The Art of Multiprocessor Programming</em>, Morgan Kaufmann, 2012.</li>
</ul>
<h3 id="quick-start">Quick Start</h3>
<ol start="0" type="1">
<li><p>Launch a fresh terminal window.</p></li>
<li><p>Set up environment variables and tools.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="va">&gt; cd Synchronicity/workspace/Synchronicity</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="va">&gt; source msetup</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>Anchor Configuration</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">--------------------</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a>ANCHOR_HOME = /home/artifact/Synchronicity/workspace/Synchronicity</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>Commands</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="kw">--------</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>anchor             -&gt; /home/artifact/Synchronicity/workspace/Synchronicity/commands/anchor</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>anchor-benchmarks  -&gt; /home/artifact/Synchronicity/workspace/Synchronicity/commands/anchor-benchmarks</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a>compile-benchmarks -&gt; /home/artifact/Synchronicity/workspace/Synchronicity/commands/compile-benchmarks</span></code></pre></div></li>
<li><p>Use anchor to verify a small file to sanity check the configuration.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/artifact</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="va">&gt; cat tests/ok1.anchor</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>class Ok { </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>  int y moves_as guarded_by this;</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>  public void inc()  {</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>    synchronized(this) { </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>      this.y = this.y + 1;</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>    }</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>  }</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>}</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="va">&gt; anchor -quiet tests/ok1.anchor</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>Processing tests/ok1.anchor...</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a>Verified!  (1.42 seconds)</span></code></pre></div>
<p>The command line flag <code>-quiet</code> turns off most anchor logging messages. You may run without that flag to see more details about how anchor operates, although the details will not be relevant to this tutorial.</p></li>
<li><p>Use anchor on a second file that contains a reduction error:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="va">&gt; cat tests/bad1.anchor</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>class Bad {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>  volatile int y moves_as isLocal(this) ? B : N;</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>  public void inc()  {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>    this.y = this.y + 1;  // error: two non-mover accesses</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>  }</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>}</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="va">&gt; anchor -quiet tests/bad1.anchor</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>Processing tests/bad1.anchor...</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>(6.5): Reduction failure</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a>               this.y = this.y + 1;  // error: two non-mover accesses</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a>               ^</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a>  Trace:</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a>     (6)     [N] tmp2 := this.y;                    {!isLocal(this, tid)  ==&gt;  N}</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a>     (6)         tmp3 = 1;                               </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a>     (6)         tmp1 = tmp2 + tmp3;                     </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a>     (6)     [N] this.y := tmp1;                    {!isLocal(this, tid)  ==&gt;  N}</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a><span class="dt">1 Errors.  (1.37 seconds)</span></span></code></pre></div>
<p>The trace shows the execution path through the method body leading to the error in a lower-level translation of the original anchor source. Each step of the trace containing a synchronization or memory operation is structured as follows:</p>
<table>
<thead>
<tr class="header">
<th>Line</th>
<th>Commutitivity</th>
<th>Operation</th>
<th>Commutivitity Computation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(6)</td>
<td>[N]</td>
<td><code>tmp2 := this.y;</code></td>
<td><code>!isLocal(this, tid)  ==&gt;  N</code></td>
</tr>
<tr class="even">
<td>(6)</td>
<td></td>
<td><code>tmp3 = 1;</code></td>
<td></td>
</tr>
<tr class="odd">
<td>(6)</td>
<td></td>
<td><code>tmp1 = tmp2 + tmp3;</code></td>
<td></td>
</tr>
<tr class="even">
<td>(6)</td>
<td>[N]</td>
<td><code>this.y := tmp1;</code></td>
<td><code>!isLocal(this, tid)  ==&gt;  N</code></td>
</tr>
</tbody>
</table>
<p>These lines reflect a possible execution that leads to a reduction failure, that is, a <code>yield</code>-free sequence whose operations do not match the reducible pattern <span class="math inline"><em>R</em><sup>*</sup>[<em>N</em>]<em>L</em><sup>*</sup></span>. For the first and fourth steps, <code>this</code> is not thread-local, so the synchronization specification</p>
<pre><code>isLocal(this) ? B : N</code></pre>
<p>indicates that the accesses will be non-movers. For the second and third, only local variables are accessed, so both steps are trivially both-movers. In trivial cases like this, we omit the commutivity from the trace for improved readability.</p></li>
<li><p>To view the heap snaphots corresponding to the error trace in the previous example, run anchor again with the <code>-snapshots</code> flag:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="va">&gt; anchor -quiet -snapshots tests/bad1.anchor</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>...</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="dt">1 Errors.  (1.38 seconds)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="va">&gt; firefox log/errors-frames.html</span></span></code></pre></div>
<p>The last line uses FireFox to open the local webpage <code>log/errors-frames.html</code>, which contains the error trace. Clicking on a memory or synchronization operation will bring up the heap snapshot of the pre-state for that line of code. All local variables appear in the frame titled <code>LOCALS</code>. Object references link to object records with names like <code>Bad.0</code>. The <code>LOCALS</code> frame is typically in the lower left of the snapshot image.</p>
<p>In this case, the only relevent item to note in the heap snapshots is that the <code>this</code> object is in the <em>Shared</em> state, and thus not local to the current thread. There are several special local variables in the diagram:</p>
<ul>
<li><p><code>tid</code>: the thread id for the currently executing thread.</p></li>
<li><p><code>_pc</code>: the phase of the current thread, as defined in the thread-modular semantics. Its value is either <em>Pre</em> or <em>Post</em>.</p></li>
</ul>
<p>There are also several special fields in each object:</p>
<ul>
<li><p><code>_lock</code>: stores the id of the thread holding the lock, or -1 if it is not held.</p></li>
<li><p><code>State</code>: one of <code>Fresh</code>, <code>Local(n)</code>, or <code>Shared</code>. These represent unallocated objects, objects local to thread <span class="math inline"><em>n</em></span>, and objects that are potential shared among multiple threads, respectively.</p></li>
</ul>
<p><strong>Note:</strong> Anchor shows the full counterexample reported by the underlying Boogie verifier.<br />
This may include many extraneous objects, depending on how exactly the SMT solver discovered the error. Our tool could filter out the irrelevent parts, but we have chosen to left them in to aid in debugging our verifier.</p></li>
</ol>
<h2 id="step-by-step-instructions">Step-By-Step Instructions</h2>
<h3 id="claims-validated-with-artifact">Claims Validated With Artifact</h3>
<ol type="1">
<li>Anchor supports automatically verifies that programs are race-free, do not go wrong (due to assertaion failures), respect their synchronization disciplines, and are P/C equivalent.</li>
<li>Anchor supports synchronization specifications that can be checked for self-consistency properties independent of implementation code.</li>
<li>Anchor provides diagnostic error messages to the programmer to support finding and fixing concurrent errors.</li>
<li>When provided, Anchor verifies functional specifications (written as post conditions) for public methods.</li>
<li>Anchor can verify complex algorithms not easily handled by the most closely related existing techniques (eg: CIVL).</li>
<li>Anchor provides a better intuitive model for which code fragments are reducible.</li>
<li>Anchor has the specification and verification time overheads reported in the paper.</li>
<li>Verified Anchor programs can be compiled and executed.</li>
</ol>
<p>We believe this list covers the major claims from the paper.</p>
<h3 id="claims-1-and-2-demonstrated-by-verifying-examples-in-the-paper-and-others">Claims 1 and 2: Demonstrated by Verifying Examples in the Paper and Others</h3>
<p>Below we list the major examples used in the body of the paper, and several other small, illustrative programs. Collectively, they demonstrate Anchor’s ability to verify the correctness criteria listed in Claim 1 and 2 by showing both positive and negative examples of the correctness properties listed. (Note: The benchmark code may be slightly different in Version 2 due to changes we made after the initial version and to the paper.)</p>
<p>For each program, we have a link to the source code, the comment line to run that code, and the expected result. All code for these examples is in the <code>workspace/artifact/papers</code> directory.</p>
<p>Follow the set up steps as above before running these examples if you are in a new shell, and also <code>cd</code> into the <code>artifact</code> directory:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="va">&gt; source msetup</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>...</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/artifact</span></span></code></pre></div>
<ul>
<li><p><strong>Paper Figure 1: <a href="paper/AtomicInt.anchor">AtomicInt.anchor</a></strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="va">&gt; anchor -quiet paper/AtomicInt.anchor</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>...</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>Verified!  (1.69 seconds)</span></code></pre></div></li>
<li><p><strong>Paper Figure 3: <a href="paper/LockBasedStack.anchor">LockBasedStack.anchor</a></strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="va">&gt; anchor -quiet paper/LockBasedStack.anchor</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>...</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>Verified!  (2.40 seconds)</span></code></pre></div></li>
<li><p><strong>Paper Figure 3: <a href="paper/LockFreeStack.anchor">LockFreeStack.anchor</a></strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="va">&gt; anchor -quiet paper/LockFreeStack.anchor</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>...</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>Verified!  (2.90 seconds)</span></code></pre></div></li>
<li><p><strong>Validity Error: <a href="paper/ValidityError.anchor">ValidityError.anchor</a></strong></p>
<p>A more interesting example of the validity error appearing in Figure 1. This shows that Anchor verifies synchronizations disciplines independent of implementation code, and that it rejects programs for which the synchronization disciplines do not imply race freedom. (The validity requirements must be satisfied to guarantee a spec rules out races.)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="va">&gt; cat paper/ValidityError.anchor</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>class BadDiscipline {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>    volatile int value moves_as isRead() ? B : N;</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>}</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="va">&gt; anchor -quiet paper/ValidityError.anchor </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>Processing paper/ValidityError.anchor...</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>(2.5): BadDiscipline.value failed Read-Write Right-Mover Check</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>    volatile int value moves_as isRead() ? B : N;</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>    ^</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>    Thread t    : _ := x.value;  [(isRead)  ==&gt;  B]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a>    Thread u    : x.value := 6;  [!isRead  ==&gt;  N]</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>(2.5): BadDiscipline.value failed Read-Write Left-Mover Check</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a>    volatile int value moves_as isRead() ? B : N;</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a>    ^</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a>    Thread t    : _ := x.value;  [(isRead)  ==&gt;  B]</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a>    Thread u    : x.value := 5;  [!isRead  ==&gt;  N]</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true"></a>...</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true"></a><span class="dt">3 Errors.  (1.25 seconds)</span></span></code></pre></div>
<p>These two errors indicate that the <code>[Valid Read-R]</code> and <code>[Valid Read-L]</code> validity requirements in Definition 5.1 are not met by the synchronizaiton discipline for the <code>value</code> field. Specifically, thread <span class="math inline"><em>t</em></span> may read the <code>value</code> field of an object while another thread <span class="math inline"><em>u</em></span> can change it. Note that this error is reported using <em>only</em> the synchronization specification.</p>
<p>The third error, which we elided above, is due to a minor detail relating to the implicit <code>yields_as</code> annotation inserted by the verifer for field <code>value</code>. Specs failing the validity checks will never conform to the basic requirements for <code>yeilds_as</code> annotations outlined in Section 8 of the paper. (In reality, we should probably suppress this warning since the root cause is validity errors.)</p></li>
</ul>
<h3 id="claim-3-demonstrated-by-verifying-examples-in-the-paper">Claim 3: Demonstrated by Verifying Examples in the Paper</h3>
<p>We show below the three <code>buggy</code> code examples from Section 2 of the paper to illustrate how Anchor reports errors in a way that facilitates debugging and fixing synchronization errors.</p>
<ul>
<li><p><strong>Paper Section 2: Anchor Error Messages: <a href="paper/ErrorMessage1.anchor">buggy() Version 1</a></strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="va">&gt; anchor -quiet paper/ErrorMessage1.anchor</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>...</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>(40.5): Reduction failure</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>   assert this.head.item == 10;</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>   ^</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a> Trace:</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>    (38)        tmp10 = 10;                             </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>    (38)        inlined this.push(tmp10) ;              </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>    (38)          item_2 = tmp10;                       </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>    (38)          this_2 = this;                        </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a>    (16)    [R]   acquire(this_2);                      </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a>    (17)          node_2 = new Node();                  </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>    (17)    [B]   tmp1_2 := this_2.head;                 {!isLocal(this_2, tid) &amp;&amp; (holds(this_2, tid))  ==&gt;  B}</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>    (17)          inlined node_2.init(item_2,tmp1_2) ;  </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>    (17)            item_2_3 = item_2;                  </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a>    (17)            next_2_3 = tmp1_2;                  </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a>    (17)            this_2_3 = node_2;                  </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>    (6)     [B]     this_2_3.item := item_2_3;           {(isLocal(this_2_3, tid)) &amp;&amp;  </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a>                                                          (isLocal(this_2_3, tid))  ==&gt;  B}</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a>    (7)     [B]     this_2_3.next := next_2_3;           {(isLocal(this_2_3, tid)) &amp;&amp;</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a>                                                          (isLocal(this_2_3, tid))  ==&gt;  B}</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a>    (5)             break exit_2_3;                     </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a>    (18)    [B]   this_2.head := node_2;                 {!isLocal(this_2, tid) &amp;&amp;</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a>                                                          (holds(this_2, tid))  ==&gt;  B}</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a>    (19)    [L]   release(this_2);                      </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a>    (40)    [E] tmp13 := this.head;                      {!isLocal(this, tid) &amp;&amp; !holds(this, tid)  ==&gt;  E}</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true"></a><span class="dt">1 Errors.  (2.73 seconds)</span></span></code></pre></div>
<p>The most closely related contemporary tool (eg: CIVL) may show a counterexample trace, but does not provide any detail as to <em>why</em> the reduction error occurred, merely that it did.</p></li>
<li><p><strong>Paper Section 2: Anchor Error Messages: <a href="paper/ErrorMessage2.anchor">buggy() Version 2</a></strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="va">&gt; anchor -quiet paper/ErrorMessage2.anchor</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>...</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>(39.5): Reduction failure</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>   acquire(this);</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>   ^</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a> Trace:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a>    (38)        tmp10 = 10;                             </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a>    (38)        inlined this.push(tmp10) ;              </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a>    (38)          item_2 = tmp10;                       </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>    (38)          this_2 = this;                        </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>    (16)    [R]   acquire(this_2);                      </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a>    (17)          node_2 = new Node();                  </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a>    (17)    [B]   tmp1_2 := this_2.head;                 {!isLocal(this_2, tid) &amp;&amp; (holds(this_2, tid))  ==&gt;  B}</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a>    (17)          inlined node_2.init(item_2,tmp1_2) ;  </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a>    (17)            item_2_3 = item_2;                  </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a>    (17)            next_2_3 = tmp1_2;                  </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a>    (17)            this_2_3 = node_2;                  </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a>    (6)     [B]     this_2_3.item := item_2_3;           {(isLocal(this_2_3, tid)) &amp;&amp;</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a>                                                          (isLocal(this_2_3, tid))  ==&gt;  B}</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a>    (7)     [B]     this_2_3.next := next_2_3;           {(isLocal(this_2_3, tid)) &amp;&amp;</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true"></a>                                                          (isLocal(this_2_3, tid))  ==&gt;  B}</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true"></a>    (5)             break exit_2_3;                     </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true"></a>    (18)    [B]   this_2.head := node_2;                 {!isLocal(this_2, tid) &amp;&amp; (holds(this_2, tid))  ==&gt;  B}</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true"></a>    (19)    [L]   release(this_2);                      </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true"></a>    (39)    [R] acquire(this);                          </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true"></a><span class="dt">1 Errors.  (2.60 seconds)</span></span></code></pre></div></li>
<li><p><strong>Paper Section 2: Anchor Error Messages: <a href="paper/ErrorMessage3.anchor">buggy() Version 3</a></strong></p>
<p>In addition to illustrating more of Anchor’s diagnostic error message features, this example demonstrates that Anchor rejects programs with <code>assert</code> statements that may fail.</p>
<p>In this case, we use the <code>-snapshots</code> flag to generate the associated heaps.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="va">&gt; anchor -snapshots -quiet paper/ErrorMessage3.anchor</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>...</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>(41.5): This assertion may not hold.</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>   assert this.head.item == 10;</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>   ^</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>...</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="dt">1 Errors.  (2.77 seconds)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a><span class="va">&gt; firefox log/errors-frames.html</span></span></code></pre></div>
<p>In the errors web page, you can see the execution trace leading to the assertion failure.</p>
<p>If you click on the hyperlink for <code>assert tmp11</code> in the error trace, you will see the heap snapshot at the point of failure. Details may vary depending on the exact counterexample produced by the underlying SMT solver, but you should be able to see that <code>this</code> in <code>LOCALS</code> refers to a stack whose <code>head.item</code> value is not 10.</p>
<p>If you click on the hyperlink for the yield in the error trace, you will see the heap before and after the yield point. Differences are marked in red, and you should see that <code>this.head</code> changed from a node with an <code>item</code> value of 10 to one with a different value in <code>item</code>.</p>
<p>Other SMT-based tools in the domain of concurrent program verification do not show a visualization of the concrete counterexample.</p></li>
</ul>
<h3 id="claim-4-demonstrated-by-verifying-examples-in-the-paper-and-others">Claim 4: Demonstrated by Verifying Examples in the Paper and Others</h3>
<p>We provide several examples with method specifications to demonstrate that Anchor will also verify post conditions for public methods.</p>
<ul>
<li><p><strong>Paper Figure 8: <a href="paper/LockBasedStackWithSpec.anchor">LockBasedStackWithSpec.anchor</a></strong></p>
<p>When verifying method post conditions, we employ the anchor flag <code>-verify=MethodSpecs</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="va">&gt; anchor -verify=MethodSpecs -quiet paper/LockBasedStackWithSpec.anchor</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>...</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>Verified!  (2.90 seconds)</span></code></pre></div>
<p>To demonstrate a failure when verifying method specifications, you can comment out line 20 of that file (<code>this.head = node;</code>) and run again. That line is marked in the file for your convenience.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="va">&gt; anchor -verify=MethodSpecs -quiet paper/LockBasedStackWithSpec.anchor</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>...</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>(17.30): Method returns before completing actions in spec</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>...</span></code></pre></div>
<p><strong>Caveat:</strong> Specification failure error messages contain some rough diagnostic info that we find useful for debugging our verifier, but that info is not necessarily intended for the end programmer.</p></li>
<li><p><strong><a href="paper/LockFreeStackWithSpec.anchor">LockFreeStackWithSpec.anchor</a></strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="va">&gt; anchor -quiet -verify=MethodSpecs paper/LockFreeStackWithSpec.anchor </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>Processing paper/LockFreeStackWithSpec.anchor...</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>Verified!  (3.03 seconds)</span></code></pre></div></li>
<li><p><strong><a href="paper/FineGrainedListWithSpec.anchor">FineGrainedListWithSpec.anchor</a></strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="va">&gt; anchor -quiet -verify=MethodSpecs paper/FineGrainedListWithSpec.anchor </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>Processing paper/FineGrainedListWithSpec.anchor...</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>Verified!  (3.15 seconds)</span></code></pre></div></li>
</ul>
<h3 id="claims-5-6-7-demonstrated-by-verifying-the-examples-in-table-1">Claims 5, 6, 7: Demonstrated by Verifying the Examples in Table 1</h3>
<ol type="1">
<li><p>Follow the set up steps as above before running the benchmarks if you are in a new shell:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="va">&gt; source msetup</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>...</span></code></pre></div></li>
<li><p>The source files for the examples in Table 1 are stored in <code>~/Synchronicity/workspace/Synchronicity/benchmarks/anchor</code>.<br />
To verify each example once, use the following command. This should complete in about 5-8 minutes.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="va">&gt; anchor-benchmarks</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>Processing benchmarks/anchor/stack-coarse.anchor...</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>Verified!  (3.65 seconds)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a>Processing benchmarks/anchor/stack-lock-free.anchor...</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a>Verified!  (2.99 seconds)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a>Processing benchmarks/anchor/list-coarse.anchor...</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a>Verified!  (4.18 seconds)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a>Processing benchmarks/anchor/list-fine.anchor...</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>Verified!  (2.86 seconds)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a>Processing benchmarks/anchor/list-optimistic.anchor...</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a>Verified!  (3.70 seconds)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a>Processing benchmarks/anchor/list-lazy.anchor...</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>Verified!  (4.06 seconds)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>Processing benchmarks/anchor/list-lock-free.anchor...</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a>Verified!  (24.36 seconds)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a>Processing benchmarks/anchor/queue-coarse.anchor...</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true"></a>Verified!  (4.35 seconds)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true"></a>Processing benchmarks/anchor/queue-lock-free.anchor...</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true"></a>Verified!  (5.12 seconds)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true"></a>Processing benchmarks/anchor/queue-bounded.anchor...</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true"></a>Verified!  (12.84 seconds)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true"></a>Processing benchmarks/anchor/hashset-coarse.anchor...</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true"></a>Verified!  (14.30 seconds)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true"></a>Processing benchmarks/anchor/hashset-striped.anchor...</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true"></a>Verified!  (188.62 seconds)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true"></a>Processing benchmarks/anchor/fasttrack.anchor...</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true"></a>Verified!  (22.21 seconds)</span></code></pre></div>
<p><strong>Caveat:</strong> The time required to verify a program depends on many factors, including the non-determinism inherent in the underlying Z3 SMT solver. We have found that moving from one computer to another or simply repeating experiments under slightly different conditions can lead to fairly sizable time differences, particularly for <code>queue-bounded.anchor</code> and <code>hashset-striped.anchor</code>. Thus, while the numbers above are typical for the VM on our hosts, they may not be entirely congruent with what you observe.</p></li>
<li><p>To verify each multiple times and report both annotation and timing statistics, use a command like the following. The command will print out a latex table that you may use to compare your timing results to those in the paper.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="va">&gt; # Runs each 10 times, reporting average time.  Hopefully &lt; 1 hour.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a><span class="va">&gt; anchor-benchmarks -n=10</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>Stacks</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a>  Coarse...</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>    Running with command: ./commands/time-anchor -quiet -B=-timeLimit:600  benchmarks/anchor/stack-coarse.anchor</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>      Warmup Run 1: 2.59 seconds</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a>      ...</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>      Run 1: 2.98 seconds</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a>      Run 2: 2.97 seconds</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a>      Run 3: 3.03 seconds</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true"></a>      ...</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true"></a>      Run 10: 3.17 seconds</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true"></a>  Lock-free...</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true"></a>    ...</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true"></a>Linked Lists</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true"></a>  ...</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true"></a>...</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true"></a><span class="va">&gt; pdflatex data.tex</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true"></a><span class="va">&gt; gnome-open data.pdf</span></span></code></pre></div>
<p>If there are any errors on a benchmark, the time will be reported as 0 and a message will tell you how to re-run the benchmark to observe the problem – we can help diagnose any errors from the output of that run.</p>
<p>We provide here logs and tables for several test machines to illustrate the expected output format and timings on<br />
different systems. As noted above, you may see some differences for several test programs.<br />
These files are stored in <code>~/Synchronicity/workspace/artifact/</code>.</p>
<ul>
<li>Virtual Machine, 2 Cores, 8 GB RAM, Ubuntu 16. Hosted on Mac Mini (next config).
<ul>
<li>Data in <code>data/vm-osx/</code>: <a href="data/vm-osx/log.txt">Log file</a> and <a href="data/vm-osx/data.pdf">PDF Table</a></li>
</ul></li>
<li>Apple Mac Mini, 3.2 GHz 6-Core Intel Core i7, 64 GB RAM, OSX 10.15.
<ul>
<li>Data in <code>data/mac-osx/</code>: <a href="data/mac-osx/log.txt">Log file</a> and <a href="data/mac-osx/data.pdf">PDF Table</a></li>
</ul></li>
</ul></li>
</ol>
<h3 id="claims-4-5-6-7-demonstrated-by-the-civl-fasttrack-case-study">Claims 4, 5, 6, 7: Demonstrated by the CIVL FastTrack Case Study</h3>
<p>We use the following measurements as our basis of comparision between the CIVL and Anchor implementations of the FastTrack dynamic race detector core algorithm. This case study further demonstrates Anchor’s ability to verify functional specifications, and it also shows that Anchor can readily verify complex synchronization and algorithms and provides an intuitive programming model by enabling to easily and succinctly encode both the FastTrack algorithm and specification. We also show how to reproduce the timing measures reported for the variants of FastTrack.</p>
<p><strong>Note:</strong> This section involves verifying full functional specifications of the FastTrack code, not just P/C equivalence.</p>
<ol type="1">
<li><p><strong>Code and Spec Size.</strong> We include five variants of FastTrack.</p>
<p>Two are implementations in CIVL:</p>
<ul>
<li><a href="verified-ft/verified-ft-code-only.bpl">~/Synchronicity/workspace/artifact/verified-ft/verified-ft-code-only.bpl</a>: the previously published CIVL implementation with no specs and no test harness.</li>
<li><a href="verified-ft/verified-ft-no-client.bpl">~/Synchronicity/workspace/artifact/verified-ft/verified-ft-no-client.bpl</a>: the previously published CIVL implementation with full specs and no test harness.</li>
</ul>
<p>Three are implementations in Anchor:</p>
<ul>
<li><a href="verified-ft/fasttrack-original.anchor">~/Synchronicity/workspace/artifact/verified-ft/fasttrack-original.anchor</a>: our Anchor implementation with no specs.</li>
<li><a href="../Synchronicity/benchmarks/anchor/fasttrack.anchor">~/Synchronicity/workspace/Synchronicity/benchmarks/anchor/fasttrack.anchor</a>: our Anchor implementation with the specs necessary to prove P/C equivalence. (A more readable version is <a href="../Synchronicity/benchmarks/verified-ft-src/fasttrack-with-macros.anchor">fasttrack-with-macros.anchor</a>. That version uses C macros for common operations in the spec.)</li>
<li><a href="../Synchronicity/benchmarks/specs/fasttrack.anchor">~/Synchronicity/workspace/Synchronicity/benchmarks/specs/fasttrack.anchor</a>: our Anchor implementation with full functional specifications matching those in the CIVL code. (A more readable version is <a href="../Synchronicity/benchmarks/verified-ft-src/fasttrack-specs-with-macros.anchor">fasttrack-specs-with-macros.anchor</a>. That version uses C macros for common operations in the spec.)</li>
</ul>
<p>Here are their sizes (lines of source code with empty lines and comments removed): **(Version 2: These counts may be off by a few lines due to improvements we have made to the specification.)</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/artifact/verified-vt</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="va">&gt; ./lines.sh </span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>File                                                                        LOC</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a><span class="kw">==========================================================================  ===</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a>~/Synchronicity/workspace/artifact/verified-ft/verified-ft-code-only.bpl    260</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>~/Synchronicity/workspace/artifact/verified-ft/verified-ft-no-client.bpl    789</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a><span class="kw">--------------------------------------------------------------------------</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a>~/Synchronicity/workspace/artifact/verified-ft/fasttrack-original.anchor    217</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a>~/Synchronicity/workspace/Synchronicity/benchmarks/anchor/fasttrack.anchor  259</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a>~/Synchronicity/workspace/Synchronicity/benchmarks/specs/fasttrack.anchor   385</span></code></pre></div>
<p>From these, the sizes of the specifications are computed as follows:</p>
<table>
<thead>
<tr class="header">
<th>Spec</th>
<th>Size (LOC)</th>
<th>Size (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CIVL spec</td>
<td><span class="math inline">789 − 260 = 529</span> lines</td>
<td><span class="math inline">529/260 = 203%</span></td>
</tr>
<tr class="even">
<td>Anchor spec for P/C equivalence</td>
<td><span class="math inline">259 − 217 = 42</span> lines</td>
<td><span class="math inline">  42/217 = 19%</span></td>
</tr>
<tr class="odd">
<td>Anchor spec for functional corretness</td>
<td><span class="math inline">385 − 217 = 168</span> lines</td>
<td><span class="math inline">168/217 = 77%</span></td>
</tr>
</tbody>
</table>
<p>Our claims related to handling such complex code more readily and intuitively are based on the dramatically reduced specification requirements, from 529 lines to 168 lines.</p></li>
<li><p><strong>Verification Time.</strong> We measured FastTrack verification under CIVL and Anchor with the following commands. Timings will differ from those reported in the paper under the VM and due to improvements in the Anchor verifier made after the initial paper submission.</p>
<p><strong>Single Runs of CIVL and Anchor:</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/artifact/verified-ft</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="va">&gt; time bpl verified-ft-no-client.bpl</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>Boogie program verifier version 2.4.1.10503, Copyright (c) 2003-2014, Microsoft.</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>Boogie program verifier finished with 522 verified, 0 errors</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a>real    0m9.786s</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true"></a>user    0m10.629s</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true"></a>sys 0m0.370s</span></code></pre></div>
<p>The real running time for CIVL is <span class="math inline">9.876</span> seconds.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="va">&gt; anchor -quiet -verify=MethodSpecs benchmarks/specs/fasttrack.anchor</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>...</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>Verified (51.49 seconds)</span></code></pre></div>
<p>The real running time for Anchor is <span class="math inline">51.49</span> seconds.</p>
<p><strong>Average of Multiple Runs of CIVL and Anchor:</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/artifact/verified-ft</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="va">&gt; time -p for i in {1..10}; do bpl -nologo verified-ft-no-client.bpl; done</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a>Boogie program verifier finished with 522 verified, 0 errors</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a>Boogie program verifier finished with 522 verified, 0 errors</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a>...</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a>Boogie program verifier finished with 522 verified, 0 errors</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a>real 101.86</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a>user 104.34</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a>sys 4.09</span></code></pre></div>
<p>So the average real time for CIVL is <span class="math inline">101.86/10 = 10.2</span> seconds.</p>
<p><strong>Version 2:</strong> For Anchor, we use a command like we did for the P/C equivalence benchmarks. Note: this will overwrite the <code>data.tex</code> file generated above. You should rename that file if you wish to preserve it. It will also run several additional examples other than FastTrack, but they will not take long.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a><span class="va">&gt; # Runs each 10 times, reporting average time.  Hopefully &lt; 15 minutes</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a><span class="va">&gt; anchor-benchmarks -specs -n=10</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>...</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a><span class="va">&gt; pdflatex data.tex</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a><span class="va">&gt; gnome-open data.pdf</span></span></code></pre></div>
<p>These data files are also stored in <code>~/Synchronicity/workspace/artifact/</code>.</p>
<ul>
<li>Virtual Machine, 2 Cores, 8 GB RAM, Ubuntu 16. Hosted on Mac Mini (next config).
<ul>
<li>Data in <code>data/vm-osx-specs/</code>: <a href="data/vm-osx-specs/log.txt">Log file</a> and <a href="data/vm-osx-specs/data.pdf">PDF Table</a></li>
</ul></li>
<li>Apple Mac Mini, 3.2 GHz 6-Core Intel Core i7, 64 GB RAM, OSX 10.15.
<ul>
<li>Data in <code>data/mac-osx-specs/</code>: <a href="data/mac-osx-specs/log.txt">Log file</a> and <a href="data/mac-osx-specs/data.pdf">PDF Table</a></li>
</ul></li>
</ul>
<p>This experiment can also yield fairly different timing results on different platforms…</p></li>
</ol>
<h3 id="version-2-claims-4567-demonstrated-by-our-armada-queue-case-study"><strong>Version 2:</strong> Claims 4,5,6,7: Demonstrated by our Armada Queue Case Study</h3>
<ol type="1">
<li><p><strong>Code and Spec Size.</strong></p>
<p>Our Queue code is in:</p>
<ul>
<li><a href="../Synchronicity/benchmarks/specs/queue.anchor">~/Synchronicity/workspace/Synchronicity/benchmarks/specs/queue.anchor</a>: our Anchor implementation with full functional specifications matching those in the Armada code. (A more readable version is <a href="../Synchronicity/benchmarks/queue-src/queue-with-macros.anchor">fasttrack-specs-with-macros.anchor</a>. That version uses C macros for common operations in the spec.)</li>
</ul>
<p>Here are their sizes (lines of source code with empty lines and comments removed):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/artifact/queue</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a><span class="va">&gt; ./lines.sh </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a>File                                                                         LOC</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a><span class="kw">==========================================================================   ===</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a>~/other/Synchronicity/workspace/artifact/queue/queue-original.anchor         35</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>~/other/Synchronicity/workspace/Synchronicity/benchmarks/specs/queue.anchor  62</span></code></pre></div>
<p>For Armada, we sum the constituent parts of the code and spec as stated in the PLDI ’20 paper.</p></li>
<li><p><strong>Verification Time.</strong> We measured verification times for Armada and Anchor with the following commands. Timings will differ from those reported in the paper under the VM.</p>
<p><strong>For Armada</strong>:</p>
<p>We downloaded the PLDI ’20 Armada artifact from <a href="https://doi.org/10.1145/3395653">https://doi.org/10.1145/3395653</a> and followed the instructions to launch a Docker container configured to use 4 cores and 16 GB. We followed the artifact intructions to create the proof code and then measured the time to verify the proof for the queue benchmark (qbss). It was 36 minutes on our test machine.</p>
<p><strong>Single Run of Anchor:</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a><span class="va">&gt; # -maxTid=1 indicates to anchor only 2 threads use the queue.</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a><span class="va">&gt; anchor -quiet -verify=MethodSpecs -maxTid=1 benchmarks/specs/queue.anchor</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a>...</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a>Verified (14.21 seconds)</span></code></pre></div>
<p><strong>Average of Multiple Runs Anchor:</strong></p>
<p>This is generated by the common in the FastTrack section and appears in the same pdf tables as above:</p>
<ul>
<li>Virtual Machine, 2 Cores, 8 GB RAM, Ubuntu 16. Hosted on Mac Mini (next config).
<ul>
<li>Data in <code>data/vm-osx-specs/</code>: <a href="data/vm-osx-specs/log.txt">Log file</a> and <a href="data/vm-osx-specs/data.pdf">PDF Table</a></li>
</ul></li>
<li>Apple Mac Mini, 3.2 GHz 6-Core Intel Core i7, 64 GB RAM, OSX 10.15.
<ul>
<li>Data in <code>data/mac-osx-specs/</code>: <a href="data/mac-osx-specs/log.txt">Log file</a> and <a href="data/mac-osx-specs/data.pdf">PDF Table</a></li>
</ul></li>
</ul></li>
</ol>
<h3 id="claim-8-demonstrated-by-compiling-and-testing-the-examples-in-table-1">Claim 8: Demonstrated by Compiling and Testing the Examples in Table 1</h3>
<p>To compile and test the examples in Table 1, you can use the following command:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a><span class="va">&gt; compile-benchmarks -quiet</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>### stack-coarse</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>Generating Jar File benchmarks/jars/stack-coarse.jar</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a>Running Unit Tests</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a>JUnit version 4.12</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a>.sequential push and pop</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true"></a>.parallel both</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true"></a>.parallel push</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true"></a>.parallel pop</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true"></a>Time: 0.007</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true"></a>OK (4 tests)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true"></a>### stack-lock-free</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true"></a>...</span></code></pre></div>
<p>All examples should end with <code>OK</code>. The compiler generates Java code, which is in <code>benchmarks/java</code>. That code is then compiled and bundled into jar files in <code>benchmarks/jars</code>. The unit tests are in <code>benchmarks/unit-tests</code>. They are based on the tests that come with the source from the Herlihy and Shavit book.</p>
<h2 id="building-and-unit-tests">Building and Unit Tests</h2>
<p>The Anchor source can be recompiled as follows:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="va">&gt; cd ~/Synchronicity/workspace/Synchronicity</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a><span class="va">&gt; make</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>mkdir -p bin</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>javac -d bin -classpath &quot;.:tools/*&quot; `find src -name &quot;*.java&quot;` </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a>fsc -d bin -classpath &quot;.:tools/*&quot; `find src -name &quot;*.java&quot;` `find src -name &quot;*.scala&quot;`</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a><span class="va">&gt; # run unit tests in ./tests directory (15-30 minutes)</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a><span class="va">&gt; make tests</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true"></a>...</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true"></a>Run starting. Expected test count is: 196</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true"></a>SpecTests:</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true"></a>Spec Tests</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true"></a><span class="st">- Example2.anchor should succeed</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true"></a><span class="st">- a.anchor should succeed</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true"></a><span class="st">- aba.anchor should fail with 1 errors</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true"></a><span class="st">- annot-1.sink should fail with 1 errors</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true"></a><span class="st">- array-bad-1.sink should fail with 14 errors</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true"></a>...</span></code></pre></div>
<p>While not part of the submitted artifact, if you wish to install Anchor on a different computer, please follow the <a href="install.html">installation instructions</a>. We believe them to be relatively portable to different platforms, but your mileage may vary…</p>
<h2 id="known-issues-and-caveats">Known Issues And Caveats</h2>
<ul>
<li><p>The Z3 solver’s proof search is non-deterministic. As such, switching machines, repeating queries, making small changes in the input, etc. can all have an impact on performance. This impacts some test inputs more than others, and you may see observe different timing results for some programs than we observed on our test machine. In the extreme, this can lead to non-termination for programs we were able to verify. We don’t anticipate that happening but can provide some guidance to work around that limitation.</p></li>
<li><p>Anchor shows the full counterexample reported by the underlying Boogie verifier.<br />
This may include many extraneous objects, depending on how exactly the SMT solver discovered the error. Our tool could filter out the irrelevent parts, but we have chosen to left them in to aid in debugging our verifier.</p></li>
<li><p>Anchor only parses a subset of the format for counterexamples produced by Boogie/Z3. While we have not encountered problems resulting from this in the examples presented here, if Anchor reports warnings about the Boogie counterexample, it is due to this limitation and parts of the counterexample will not be presented in the heap snapshot.</p></li>
</ul>
</body>
</html>
